this is a repo for clinical causal inference. it needs a major new feature: the ability to generate a gold standard synthetic dataset using an LLM for which there is a true underlying data structure. This is how it should work. create a new folder called synthetic_data. create a script to generate the dataset. it should be based on some comparative effectiveness question provided by the user. A default could be "compare the effectiveness of letrozole+palbociclib with letrozole+ribociclib for the first line treatment of metastatic ER positive breast cancer." The user should also provide a dataset size, default 500. based on the clinical question, prompt an LLM to generate a list of realistic confounder variables. Common ones might include age, sex (for cancers that aren't sex-specific), smoking history, performance status, prior treatment (yes/no), etc. some should be categorical, and some should be continuous. 

For all LLM prompting, user should provide arguments to access an openai compatible API. Usually this should mean a url and API key (key may be blank for locally running models ie with vllm). 

Parse the list of generated confounders into a true list. Then, prompt the LLM to create two plausible equations: one for predicting treatment assignment, and one for predicting binary outcome using the confounders. The equation  should yield output in the form of logits of treatment and outcome respectively. Some equations should include interactions among confounders. The outcome prediction equation should include treatment as a predictor, with an assigned coefficient provided as an argument by the user (default 1.0 on the logit scale).

Also, prompt the LLM to generate a realistic summary statistics table. this should indicate the proportion of patients in each category of a categorical confounder; and the mean and SD of any continuous variables.

Then, prompt the LLM to generate the clinical history document for each patient in the dataset. To create each history document, patient characteristics should be sampled from the summary statistics table. The history document generated should then be quite long, reflecting how in real data, we concatenate together all historical radiology reports, pathology reports, and clinical notes for each patient. the LLM prompt for each patient should include the patient characteristics sampled from the summary statistics table.  Similarly, calculate the treatment for each patient based on the regression equation for treatment (sampling a binary outcome based on the logit of treatment), and similarly the outcome for each patient based on the regression equation for outcome. Generate an output dataset with columns patient_prompt (indicating the patient characteristics sampled into a prompt for that patient); the synthetic clinical history; the treatment variable; the outcome variable; the true treatment logit; and the true outcome logit. this table, plus a JSON with the original prompt, other arguments, regression equations, and frequency table, should go into an output folder specified by the user. think hard (ultrathink) about this complicatted task.